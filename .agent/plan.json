{
    "goal": "Refactor Section 3 of refactoring_backlog.md (Deep Nesting)",
    "steps": [
        {
            "id": 1,
            "name": "Refactor Personas Page (Level 130)",
            "description": "Extract components from `apps/web/src/pages/personas.rs` to reduce nesting.",
            "file": "apps/web/src/pages/personas.rs",
            "action": "extract_components",
            "targets": [
                "PersonaDetailModal",
                "PersonaGrid",
                "PersonaHeader"
            ],
            "commit_message": "refactor(web): extract components from personas page to reduce nesting"
        },
        {
            "id": 2,
            "name": "Refactor Memory Page (Level 36)",
            "description": "Extract components from `apps/web/src/pages/memory.rs`.",
            "file": "apps/web/src/pages/memory.rs",
            "action": "extract_components",
            "targets": [
                "GraphHeader",
                "GraphControls",
                "GraphLegend",
                "NodeDetailsPanel"
            ],
            "commit_message": "refactor(web): extract components from memory page"
        },
        {
            "id": 3,
            "name": "Refactor Voice Controller (Level 45)",
            "description": "Flatten nested logic in `crates/cratos-audio/src/controller.rs`.",
            "file": "crates/cratos-audio/src/controller.rs",
            "action": "flatten_logic",
            "targets": [
                "handle_voice_command",
                "process_audio_samples"
            ],
            "commit_message": "refactor(audio): flatten voice controller loop logic"
        },
        {
            "id": 4,
            "name": "Refactor MCP Transport (Level 24)",
            "description": "Flatten SSE parsing logic in `crates/cratos-tools/src/mcp/transport.rs`.",
            "file": "crates/cratos-tools/src/mcp/transport.rs",
            "action": "flatten_logic",
            "commit_message": "refactor(tools): flatten mcp transport sse parsing"
        },
        {
            "id": 5,
            "name": "Refactor CLI Skill (Level 23)",
            "description": "Flatten CLI handler in `src/cli/skill`.",
            "file": "src/cli/skill",
            "action": "flatten_logic",
            "commit_message": "refactor(cli): flatten skill command handlers"
        },
        {
            "id": 6,
            "name": "Refactor Tool & Routing Logic (Level 6)",
            "description": "Refactor `bash/tool.rs` and `orchestrator/routing.rs`.",
            "files": [
                "crates/cratos-tools/src/builtins/bash/tool.rs",
                "crates/cratos-core/src/orchestrator/routing.rs"
            ],
            "action": "apply_guard_clauses",
            "commit_message": "refactor(core): apply guard clauses to tools and routing"
        },
        {
            "id": 7,
            "name": "Refactor Telegram Handler (Level 5)",
            "description": "Split message handlers in `crates/cratos-channels/src/telegram/handler.rs`.",
            "file": "crates/cratos-channels/src/telegram/handler.rs",
            "action": "extract_handlers",
            "commit_message": "refactor(channels): split telegram message handlers"
        }
    ],
    "review_criteria": {
        "completeness": "All 8 items in Section 3 addressed",
        "simplicity": "No over-engineering, pure refactoring",
        "safety": "Existing tests must pass"
    }
}