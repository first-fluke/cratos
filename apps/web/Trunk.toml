# Trunk configuration for WASM builds

[build]
# Target directory
target = "index.html"
# Output directory
dist = "dist"
# Public URL
public_url = "/"

[watch]
# Watch paths
watch = ["src", "style", "index.html"]
# Ignore patterns
ignore = ["target"]

[serve]
# Dev server port
port = 19528
# Open browser automatically
open = false

[[proxy]]
rewrite = "/api/"
backend = "http://127.0.0.1:19527/api/"

[[proxy]]
rewrite = "/docs/"
backend = "http://127.0.0.1:19527/docs/"

[[proxy]]
rewrite = "/health/"
backend = "http://127.0.0.1:19527/health/"

[[proxy]]
rewrite = "/ws/"
backend = "ws://127.0.0.1:19527/ws/"
ws = true

[[hooks]]
# Run Tailwind CSS build before trunk
stage = "pre_build"
command = "sh"
command_arguments = ["-c", "npx tailwindcss -i ./style/tailwind.css -o ./style/output.css --minify 2>/dev/null || echo 'Tailwind CSS not installed, skipping...'"]
